<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <title>STH Visual Demo</title>

        <link href="/demo/src/css/index.css" rel="stylesheet" />

        <link href="/dist/sth-visual.css" rel="stylesheet" />

        <script src="/src/index.js" type="module"></script>
    </head>
    <body>
        <section class="Posts">
            <article
                class="Post"
                data-STHVisual-role="instance"
                data-STHVisual-data='{
"title":"Visual Instance A",
"items": [
  {
    "id":"item-0",
    "video": {
      "combined": "https://player.vimeo.com/progressive_redirect/playback/1058558705/rendition/1080p/file.mp4?loc=external&log_user=0&signature=cae0020d77bdfd43a204a1578be86f2117093ef078033494cff113cb333842f4&user_id=101060412",
      "width": 1280,
      "height": 720,
      "thumbnail": "https://i.vimeocdn.com/video/1984738722-249d5524ab725c54b19ef36f818b18c5e41c699a44e9779887eb721942476237-d_126x142"
    }
  },
  {
    "id":"item-1",
    "video": {
      "combined": "https://player.vimeo.com/progressive_redirect/playback/1058558705/rendition/1080p/file.mp4?loc=external&log_user=0&signature=cae0020d77bdfd43a204a1578be86f2117093ef078033494cff113cb333842f4&user_id=101060412",
      "width": 1280,
      "height": 720
    }
  },
  {
    "id":"item-2",
    "video": {
      "combined": "https://player.vimeo.com/progressive_redirect/playback/1058558705/rendition/1080p/file.mp4?loc=external&log_user=0&signature=cae0020d77bdfd43a204a1578be86f2117093ef078033494cff113cb333842f4&user_id=101060412",
      "width": 1280,
      "height": 720
    }
  },
  {
    "id":"item-3",
    "video": {
      "combined": "https://player.vimeo.com/progressive_redirect/playback/1058558705/rendition/1080p/file.mp4?loc=external&log_user=0&signature=cae0020d77bdfd43a204a1578be86f2117093ef078033494cff113cb333842f4&user_id=101060412",
      "width": 1280,
      "height": 720
    }
  },
  {
    "id":"item-4",
    "video": {
      "combined": "https://player.vimeo.com/progressive_redirect/playback/1058558705/rendition/1080p/file.mp4?loc=external&log_user=0&signature=cae0020d77bdfd43a204a1578be86f2117093ef078033494cff113cb333842f4&user_id=101060412",
      "width": 1280,
      "height": 720
    }
  }
]}'
            >
                <nav class="Post-ui">
                    <button data-Demo-role="ui/prev">prev</button>
                    <button data-Demo-role="ui/next">next</button>
                    <button data-Demo-role="ui/go" data-Demo-index="3">[3]</button>
                </nav>
            </article>

            <article
                class="Post"
                data-STHVisual-role="instance"
                data-STHVisual-data='{
"title":"Visual Instance B",
"items": [
{
"id":"item-0",
"video": {
  "combined": "https://player.vimeo.com/progressive_redirect/playback/1058558705/rendition/1080p/file.mp4?loc=external&log_user=0&signature=cae0020d77bdfd43a204a1578be86f2117093ef078033494cff113cb333842f4&user_id=101060412",
  "width": 1280,
  "height": 720,
  "thumbnail": "https://i.vimeocdn.com/video/1984738722-249d5524ab725c54b19ef36f818b18c5e41c699a44e9779887eb721942476237-d_126x142"
}
},
{
"id":"item-1",
"video": {
  "combined": "https://player.vimeo.com/progressive_redirect/playback/1058558705/rendition/1080p/file.mp4?loc=external&log_user=0&signature=cae0020d77bdfd43a204a1578be86f2117093ef078033494cff113cb333842f4&user_id=101060412",
  "width": 1280,
  "height": 720
}
}
]}'
            >
                <nav class="Post-ui">
                    <button data-Demo-role="ui/prev">prev</button>
                    <button data-Demo-role="ui/next">next</button>
                    <button data-Demo-role="ui/go" data-Demo-index="3">[3]</button>
                </nav>
            </article>
        </section>

        <script>
            /**
             * Pseudo code to demonstrate how to trigger slider navigation on the
             * STHVisual Module by calling a custom event on the instance element
             *
             * Event name is  `STHVisual/api`
             * Data object needs to contain an action of `prev`, `next`, `go`
             * `go`requires an additional index property in the data object
             *
             */
            document.body.addEventListener('click', (event) => {
                // next / prev buttons
                if (event.target.matches('[data-Demo-role^="ui"]')) {
                    event.preventDefault();
                    event.stopPropagation();

                    const action = event.target.getAttribute('data-Demo-role').replace('ui/', '');
                    const instanceElement = event.target.closest('[data-STHVisual-role~="instance"]');
                    const customEventData = {
                        action: action,
                        index: parseInt(event.target.getAttribute('data-Demo-index')),
                    };

                    const customEvent = new CustomEvent(`STHVisual/api`, { detail: customEventData });
                    instanceElement.dispatchEvent(customEvent);
                }
            });
        </script>
    </body>
</html>
